<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>I Love You Hoang Yen</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

<style>
html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #000;
    font-family: 'Great Vibes', cursive;
}

canvas {
    position: fixed;
    inset: 0;
    z-index: 0;
}

/* START SCREEN */
#start {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle, #2a001a, #000);
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 26px;
    z-index: 99;
    text-align: center;
}

/* HEART */
.heart {
    position: absolute;
    width: min(60vw, 240px);
    height: min(55vw, 220px);
    left: 50%;
    top: 40%;
    transform: translate(-50%, -50%) rotate(-45deg);
    animation: beat 1.2s infinite;
    z-index: 10;
}

.heart::before,
.heart::after {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, #ff0066, #ffb6e6);
    border-radius: 50%;
    box-shadow: 0 0 60px rgba(255,80,160,.9);
}

.heart::before { top: -50%; }
.heart::after  { left: 50%; }

/* HEART TEXT */
.text {
    position: absolute;
    inset: 0;
    transform: rotate(45deg);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: #fff;
    font-size: clamp(22px, 6vw, 36px);
    line-height: 1.4;
    text-shadow:
        0 0 12px #fff,
        0 0 30px #ff77cc,
        0 0 60px #ff3399;
}

/* TYPE LOVE TEXT */
#type-love {
    position: absolute;
    top: 65%;
    width: 100%;
    text-align: center;
    font-size: clamp(24px, 6vw, 42px);
    letter-spacing: 0.28em;
    color: white;
    z-index: 10;
    text-shadow:
        0 0 12px #fff,
        0 0 25px #ff66cc,
        0 0 50px #ff1493;
    animation: glow 1.5s infinite alternate;
}

@keyframes glow {
    from { opacity: 0.85; }
    to   { opacity: 1; }
}

/* FLY HEART */
.fly-heart {
    position: fixed;
    width: 16px;
    height: 16px;
    background: pink;
    transform: rotate(45deg);
    animation: fly 2s ease-out forwards;
    z-index: 20;
}
.fly-heart::before,
.fly-heart::after {
    content: "";
    position: absolute;
    width: 16px;
    height: 16px;
    background: pink;
    border-radius: 50%;
}
.fly-heart::before { top: -8px; }
.fly-heart::after  { left: -8px; }

@keyframes fly {
    to {
        transform: translateY(-200px) rotate(45deg);
        opacity: 0;
    }
}

@keyframes beat {
    0%   { transform: translate(-50%, -50%) rotate(-45deg) scale(1); }
    50%  { transform: translate(-50%, -50%) rotate(-45deg) scale(1.18); }
    100% { transform: translate(-50%, -50%) rotate(-45deg) scale(1); }
}
</style>
</head>
<body>

<div id="start">ðŸ’– Tap to Start ðŸ’–</div>

<div class="heart">
    <div class="text">
        I Love You<br>Hoang Yen
    </div>
</div>

<div id="type-love"></div>

<audio id="music" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<script src="https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.min.js"></script>
<script>
/* START + MUSIC */
const start = document.getElementById("start");
const music = document.getElementById("music");

let audioCtx, analyser, dataArray;

start.addEventListener("click", () => {
    start.style.display = "none";
    music.play().catch(()=>{});

    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const source = audioCtx.createMediaElementSource(music);
    analyser = audioCtx.createAnalyser();
    analyser.fftSize = 256;
    dataArray = new Uint8Array(analyser.frequencyBinCount);

    source.connect(analyser);
    analyser.connect(audioCtx.destination);

    document.documentElement.requestFullscreen?.().catch(()=>{});
});

/* THREE.JS LOVE UNIVERSE */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
camera.position.z = 5;

const renderer = new THREE.WebGLRenderer({alpha:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

const count = 2000;
const geo = new THREE.BufferGeometry();
const pos = new Float32Array(count * 3);

for(let i=0;i<count*3;i++){
    pos[i] = (Math.random() - 0.5) * 30;
}
geo.setAttribute("position", new THREE.BufferAttribute(pos,3));

const mat = new THREE.PointsMaterial({ color: 0xff77cc, size: 0.035 });
const stars = new THREE.Points(geo, mat);
scene.add(stars);

function animate(){
    requestAnimationFrame(animate);
    let intensity = 0;
    if(analyser){
        analyser.getByteFrequencyData(dataArray);
        intensity = dataArray.reduce((a,b)=>a+b,0)/dataArray.length;
    }
    const pulse = 1 + intensity/300;
    stars.scale.set(pulse,pulse,pulse);
    mat.color.setHSL(0.9 - intensity/600,1,0.6);
    stars.rotation.y += 0.0006 + intensity/100000;
    renderer.render(scene,camera);
}
animate();

/* TYPEWRITER LOVE */
const loveText = "I LOVE YOU HOANG YEN";
let idx = 0;
const typeBox = document.getElementById("type-love");

function typeLove(){
    if(idx < loveText.length){
        typeBox.textContent += loveText.charAt(idx++);
        setTimeout(typeLove, 150);
    }
}
setTimeout(typeLove, 2000);

/* TOUCH HEART */
document.addEventListener("touchstart", e => {
    const h = document.createElement("div");
    h.className = "fly-heart";
    h.style.left = e.touches[0].clientX + "px";
    h.style.top  = e.touches[0].clientY + "px";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),2000);
});

/* RESIZE */
addEventListener("resize",()=>{
    camera.aspect = innerWidth/innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>
